async function cancelOrder(button,storeUrl){const orderId=button.getAttribute("data-order-id");try{const{cancelOrderBehavior:cancelOrderBehavior,script:script}=window.accountSettings;if("script"===cancelOrderBehavior&&script)try{closeOrderDeletePop(orderId),eval(script)}catch(e){console.error("Error running stored script:",e),Toastify({text:"Failed to cancel order. Please try again later.",duration:3e3,gravity:"top",position:"right",backgroundColor:"rgba(132, 143, 252,1)",close:!0}).showToast()}else try{const e=await fetch("/apps/apw/app/apiordercancel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:orderId,storeUrl:storeUrl})}),t=await e.json();if(t.success){closeOrderDeletePop(orderId);const e=document.querySelector(`button[data-order-id="${orderId}"]`);e&&(e.disabled=!0,e.innerText="Order Cancelled");const t=document.querySelector(`.itemStatus[data-order-id="${orderId}"]`);t&&(t.innerText="Cancelled",t.style.color="#FDC028")}else Toastify({text:"Failed to cancel order. Please try again later.",duration:3e3,gravity:"top",position:"right",backgroundColor:"rgba(132, 143, 252,1)",close:!0}).showToast()}catch(e){console.error(e),Toastify({text:"An error occurred during order cancellation.",duration:3e3,gravity:"top",position:"right",backgroundColor:"rgba(132, 143, 252,1)",close:!0}).showToast()}}catch(e){console.error("Error in cancellation process:",e),Toastify({text:"An error occurred while processing your request.",duration:3e3,gravity:"top",position:"right",backgroundColor:"rgba(132, 143, 252,1)",close:!0}).showToast()}}async function handleSingleProduct(e){const t=e.dataset.variantId;try{fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,quantity:1})}).then((()=>{window.location.href="/checkout"}))}catch(e){Toastify({text:"Couldn't prepare your order. Please try again.",duration:3e3,gravity:"top",position:"right",backgroundColor:"rgba(132, 143, 252,1)",close:!0}).showToast()}}async function handleBuyAgain(e){const t=e.textContent;try{const t=e.closest(".order-details");if(!t)throw new Error("Order details not found");const r=t.querySelectorAll(".ordered-product");if(0===r.length)throw new Error("No products found");for(const e of r){const t=e.querySelector(".view-product")?.dataset.variantId;if(!t)continue;const r=e.querySelector(".item-price span:last-child")?.textContent,o=r?parseInt(r):1;if(!(await fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,quantity:o})})).ok)throw new Error(`Failed to add variant ${t}`)}window.location.href="/checkout"}catch(r){Toastify({text:"Couldn't prepare your order. Please try again.",duration:3e3,gravity:"top",position:"right",backgroundColor:"rgba(132, 143, 252,1)",close:!0}).showToast(),e.disabled=!1,e.textContent=t}}function view_product(e){const t=e.getAttribute("data-url");t&&(window.location.href=t)}function showProducts(e){if(document.querySelectorAll(".order-details-layout")){document.querySelectorAll(".order-details").forEach((e=>e.classList.add("hidden"))),renderPage()}}function showLogs(e){if(document.querySelectorAll(".order-page-item")){document.querySelectorAll(".order-page-item").forEach((e=>e.style.display="none"));document.querySelector(".pagination").style.display="none",document.querySelector(`.order-details[data-order-index="${e}"]`).classList.remove("hidden")}}window.showOrderDeletePop=function(e){const t=document.getElementById("deleteorderpopupModal-"+e);t&&(t.style.display="flex")},window.closeOrderDeletePop=function(e){const t=document.getElementById("deleteorderpopupModal-"+e);t&&(t.style.display="none")};let currentPage=1;const itemsPerPage=2,items=document.querySelectorAll(".order-page-item"),totalPages=Math.ceil(items.length/itemsPerPage);function renderPage(){const e=document.querySelectorAll(".order-page-item"),t=document.querySelectorAll(".order-details"),r=document.querySelector(".pagination"),o=document.getElementById("pageNumbers"),n=(currentPage-1)*itemsPerPage,a=currentPage*itemsPerPage;e.forEach(((e,t)=>{e.style.display=t>=n&&t<a?"block":"none"})),t.forEach((e=>e.classList.add("hidden"))),r.style.display="flex",o.innerHTML="";let d=Math.max(1,currentPage-Math.floor(1.5)),c=d+3-1;c>totalPages&&(c=totalPages,d=Math.max(1,c-3+1));for(let e=d;e<=c;e++){const t=document.createElement("button");t.textContent=e,t.classList.add("page-number"),e===currentPage&&t.classList.add("active"),t.setAttribute("onclick",`goToPage(${e})`),o.appendChild(t)}document.getElementById("prevPage").disabled=1===currentPage,document.getElementById("nextPage").disabled=currentPage===totalPages}function prevPage(){currentPage>1&&(currentPage--,renderPage())}function nextPage(){const e=document.querySelectorAll(".order-page-item"),t=Math.ceil(e.length/itemsPerPage);currentPage<t&&(currentPage++,renderPage())}function goToPage(e){currentPage=e,renderPage()}document.addEventListener("DOMContentLoaded",(function(){renderPage()}));